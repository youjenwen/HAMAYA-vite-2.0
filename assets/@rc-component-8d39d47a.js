import{d as M,c as Tr,f as A,g as Kr,h as mn}from"./@babel-54babf39.js";import{r as n}from"./react-5cc2acaa.js";import{r as gn}from"./react-dom-5c3c3723.js";import{c as lr,b as q,g as hn,u as yn,r as Br,s as Zr,d as pr,e as We,i as Vr,f as Cn,h as wn,j as Mn,k as Sn}from"./rc-util-237d8e9a.js";import{c as Fe}from"./classnames-5c20d0be.js";import{R as en}from"./rc-resize-observer-1aef1ecb.js";import{C as rn}from"./rc-motion-f2ce7434.js";var nn=n.createContext(null),qr=[];function Rn(e,t){var r=n.useState(function(){if(!lr())return null;var C=document.createElement("div");return C}),u=M(r,1),o=u[0],l=n.useRef(!1),s=n.useContext(nn),d=n.useState(qr),f=M(d,2),m=f[0],R=f[1],h=s||(l.current?void 0:function(C){R(function(k){var g=[C].concat(Tr(k));return g})});function E(){o.parentElement||document.body.appendChild(o),l.current=!0}function x(){var C;(C=o.parentElement)===null||C===void 0||C.removeChild(o),l.current=!1}return q(function(){return e?s?s(E):E():x(),x},[e]),q(function(){m.length&&(m.forEach(function(C){return C()}),R(qr))},[m]),[o,h]}function bn(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var Pn="rc-util-locker-".concat(Date.now()),Or=0;function Dn(e){var t=!!e,r=n.useState(function(){return Or+=1,"".concat(Pn,"_").concat(Or)}),u=M(r,1),o=u[0];q(function(){if(t){var l=hn(),s=bn();yn(`
html body {
  overflow-y: hidden;
  `.concat(s?"width: calc(100% - ".concat(l,"px);"):"",`
}`),o)}else Br(o);return function(){Br(o)}},[t,o])}var Qr=!1;function En(e){return typeof e=="boolean"&&(Qr=e),Qr}var Ur=function(t){return t===!1?!1:!lr()||!t?null:typeof t=="string"?document.querySelector(t):typeof t=="function"?t():t},tn=n.forwardRef(function(e,t){var r=e.open,u=e.autoLock,o=e.getContainer;e.debug;var l=e.autoDestroy,s=l===void 0?!0:l,d=e.children,f=n.useState(r),m=M(f,2),R=m[0],h=m[1],E=R||r;n.useEffect(function(){(s||r)&&h(r)},[r,s]);var x=n.useState(function(){return Ur(o)}),C=M(x,2),k=C[0],g=C[1];n.useEffect(function(){var ee=Ur(o);g(ee??null)});var I=Rn(E&&!k),K=M(I,2),V=K[0],Z=K[1],b=k??V;Dn(u&&r&&lr()&&(b===V||b===document.body));var v=null;if(d&&Zr(d)&&t){var U=d;v=U.ref}var N=pr(v,t);if(!E||!lr()||k===void 0)return null;var ue=b===!1||En(),p=d;return t&&(p=n.cloneElement(d,{ref:N})),n.createElement(nn.Provider,{value:Z},ue?p:gn.createPortal(p,b))}),Yr=n.createContext(null);function Xr(e){return e?Array.isArray(e)?e:[e]:[]}function kn(e,t,r){var u=Xr(t??e),o=Xr(r??e);return[new Set(u),new Set(o)]}function Nn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return r?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function xn(e,t,r,u){for(var o=r.points,l=Object.keys(e),s=0;s<l.length;s+=1){var d,f=l[s];if(Nn((d=e[f])===null||d===void 0?void 0:d.points,o,u))return"".concat(t,"-placement-").concat(f)}return""}function Jr(e,t,r,u){return t||(r?{motionName:"".concat(e,"-").concat(r)}:u?{motionName:u}:null)}function sr(e){return e.ownerDocument.defaultView}function Lr(e){for(var t=[],r=e==null?void 0:e.parentElement,u=["hidden","scroll","auto"];r;){var o=sr(r).getComputedStyle(r),l=o.overflowX,s=o.overflowY;(u.includes(l)||u.includes(s))&&t.push(r),r=r.parentElement}return t}function ur(e){return Number.isNaN(e)?1:e}function Gr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[e[0],e[1]]}function Ee(e,t){var r=t[0],u=t[1],o,l;return r==="t"?l=e.y:r==="b"?l=e.y+e.height:l=e.y+e.height/2,u==="l"?o=e.x:u==="r"?o=e.x+e.width:o=e.x+e.width/2,{x:o,y:l}}function me(e,t){var r={t:"b",b:"t",l:"r",r:"l"};return e.map(function(u,o){return o===t?r[u]||"c":u}).join("")}function $n(e,t,r,u,o,l,s){var d=n.useState({ready:!1,offsetX:0,offsetY:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:o[u]||{}}),f=M(d,2),m=f[0],R=f[1],h=n.useRef(0),E=n.useMemo(function(){return t?Lr(t):[]},[t]),x=We(function(){if(t&&r&&e){var g=t,I=g.style.left,K=g.style.top,V=g.ownerDocument,Z=sr(g),b=A(A({},o[u]),l);g.style.left="0",g.style.top="0";var v;if(Array.isArray(r))v={x:r[0],y:r[1],width:0,height:0};else{var U=r.getBoundingClientRect();v={x:U.x,y:U.y,width:U.width,height:U.height}}var N=g.getBoundingClientRect(),ue=Z.getComputedStyle(g),p=ue.width,ee=ue.height,Y=V.documentElement,Se=Y.clientWidth,X=Y.clientHeight,re=Y.scrollWidth,L=Y.scrollHeight,ge=Y.scrollTop,Re=Y.scrollLeft,W=N.height,F=N.width,z=v.height,O=v.width,c=b.htmlRegion==="scroll"?{left:-Re,top:-ge,right:re-Re,bottom:L-ge}:{left:0,top:0,right:Se,bottom:X};(E||[]).forEach(function(oe){if(!(oe instanceof HTMLBodyElement)){var T=oe.getBoundingClientRect(),Me=oe.offsetHeight,Ie=oe.clientHeight,ie=oe.offsetWidth,br=oe.clientWidth,Pr=ur(Math.round(T.width/ie*1e3)/1e3),Dr=ur(Math.round(T.height/Me*1e3)/1e3),Er=(ie-br)*Pr,er=(Me-Ie)*Dr,kr=T.x+T.width-Er,Nr=T.y+T.height-er;c.left=Math.max(c.left,T.left),c.top=Math.max(c.top,T.top),c.right=Math.min(c.right,kr),c.bottom=Math.min(c.bottom,Nr)}}),g.style.left=I,g.style.top=K;var le=ur(Math.round(F/parseFloat(p)*1e3)/1e3),_=ur(Math.round(W/parseFloat(ee)*1e3)/1e3);if(le===0||_===0||Vr(r)&&!Cn(r))return;var ke=b.offset,he=b.targetOffset,se=ke||[],J=M(se,2),be=J[0],ce=be===void 0?0:be,je=J[1],ye=je===void 0?0:je,cr=he||[],Ne=M(cr,2),G=Ne[0],fr=G===void 0?0:G,Be=Ne[1],vr=Be===void 0?0:Be;v.x+=fr,v.y+=vr;var qe=b.points||[],j=M(qe,2),dr=j[0],mr=j[1],ne=Gr(mr),$=Gr(dr),Ce=Ee(v,ne),Oe=Ee(N,$),fe=A({},b),P=Ce.x-Oe.x+ce,w=Ce.y-Oe.y+ye,te=Ee(v,["t","l"]),Qe=Ee(N,["t","l"]),Ue=Ee(v,["b","r"]),Ye=Ee(N,["b","r"]),Pe=b.overflow||{},Xe=Pe.adjustX,gr=Pe.adjustY,xe=Pe.shiftX,H=Pe.shiftY,Je=function(T){return typeof T=="boolean"?T:T>=0},ae=N.y+w,De=ae+W,$e=Je(gr),Te=$[0]===ne[0];$e&&$[0]==="t"&&De>c.bottom&&(Te?w-=W-z:w=te.y-Ye.y-ye,fe.points=[me($,0),me(ne,0)]),$e&&$[0]==="b"&&ae<c.top&&(Te?w+=W-z:w=Ue.y-Qe.y-ye,fe.points=[me($,0),me(ne,0)]);var B=N.x+P,Ve=B+F,Le=Je(Xe),ze=$[1]===ne[1];Le&&$[1]==="l"&&Ve>c.right&&(ze?P-=F-O:P=te.x-Ye.x-ce,fe.points=[me($,1),me(ne,1)]),Le&&$[1]==="r"&&B<c.left&&(ze?P+=F-O:P=Ue.x-Qe.x-ce,fe.points=[me($,1),me(ne,1)]);var ve=xe===!0?0:xe;typeof ve=="number"&&(B<c.left&&(P-=B-c.left,v.x+O<c.left+ve&&(P+=v.x-c.left+O-ve)),Ve>c.right&&(P-=Ve-c.right,v.x>c.right-ve&&(P+=v.x-c.right+ve)));var de=H===!0?0:H;typeof de=="number"&&(ae<c.top&&(w-=ae-c.top,v.y+z<c.top+de&&(w+=v.y-c.top+z-de)),De>c.bottom&&(w-=De-c.bottom,v.y>c.bottom-de&&(w+=v.y-c.bottom+de)));var _e=N.x+P,Ge=_e+F,we=N.y+w,Ke=we+W,Ze=v.x,pe=Ze+O,He=v.y,hr=He+z,Ae=Math.max(_e,Ze),yr=Math.min(Ge,pe),Q=(Ae+yr)/2,Cr=Q-_e,wr=Math.max(we,He),Mr=Math.min(Ke,hr),Sr=(wr+Mr)/2,Rr=Sr-we;s==null||s(t,fe),R({ready:!0,offsetX:P/le,offsetY:w/_,arrowX:Cr/le,arrowY:Rr/_,scaleX:le,scaleY:_,align:fe})}}),C=function(){h.current+=1;var I=h.current;Promise.resolve().then(function(){h.current===I&&x()})},k=function(){R(function(I){return A(A({},I),{},{ready:!1})})};return q(k,[u]),q(function(){e||k()},[e]),[m.ready,m.offsetX,m.offsetY,m.arrowX,m.arrowY,m.scaleX,m.scaleY,m.align,C]}function Tn(e,t,r,u){q(function(){if(e&&t&&r){let R=function(){u()};var o=t,l=r,s=Lr(o),d=Lr(l),f=sr(l),m=new Set([f].concat(Tr(s),Tr(d)));return m.forEach(function(h){h.addEventListener("scroll",R,{passive:!0})}),f.addEventListener("resize",R,{passive:!0}),u(),function(){m.forEach(function(h){h.removeEventListener("scroll",R),f.removeEventListener("resize",R)})}}},[e,t,r])}function Vn(e){var t=e.prefixCls,r=e.align,u=e.arrowX,o=u===void 0?0:u,l=e.arrowY,s=l===void 0?0:l,d=n.useRef();if(!r||!r.points)return null;var f={position:"absolute"};if(r.autoArrow!==!1){var m=r.points[0],R=r.points[1],h=m[0],E=m[1],x=R[0],C=R[1];h===x||!["t","b"].includes(h)?f.top=s:h==="t"?f.top=0:f.bottom=0,E===C||!["l","r"].includes(E)?f.left=o:E==="l"?f.left=0:f.right=0}return n.createElement("div",{ref:d,className:"".concat(t,"-arrow"),style:f})}function Ln(e){var t=e.prefixCls,r=e.open,u=e.zIndex,o=e.mask,l=e.motion;return o?React.createElement(rn,Kr({},l,{motionAppear:!0,visible:r,removeOnLeave:!0}),function(s){var d=s.className;return React.createElement("div",{style:{zIndex:u},className:Fe("".concat(t,"-mask"),d)})}):null}var zn=n.forwardRef(function(e,t){var r=e.popup,u=e.className,o=e.prefixCls,l=e.style,s=e.target,d=e.onVisibleChanged,f=e.open,m=e.keepDom,R=e.onClick,h=e.mask,E=e.arrow,x=e.align,C=e.arrowX,k=e.arrowY,g=e.motion,I=e.maskMotion,K=e.forceRender,V=e.getPopupContainer,Z=e.autoDestroy,b=e.portal,v=e.zIndex,U=e.onMouseEnter,N=e.onMouseLeave,ue=e.ready,p=e.offsetX,ee=e.offsetY,Y=e.onAlign,Se=e.onPrepare,X=e.stretch,re=e.targetWidth,L=e.targetHeight,ge=typeof r=="function"?r():r,Re=f||m,W=(V==null?void 0:V.length)>0,F=n.useState(!V||!W),z=M(F,2),O=z[0],c=z[1];if(q(function(){!O&&W&&s&&c(!0)},[O,W,s]),!O)return null;var le=ue||!f?{left:p,top:ee}:{left:"-1000vw",top:"-1000vh"},_={};return X&&(X.includes("height")&&L?_.height=L:X.includes("minHeight")&&L&&(_.minHeight=L),X.includes("width")&&re?_.width=re:X.includes("minWidth")&&re&&(_.minWidth=re)),f||(_.pointerEvents="none"),n.createElement(b,{open:K||Re,getContainer:V&&function(){return V(s)},autoDestroy:Z},n.createElement(Ln,{prefixCls:o,open:f,zIndex:v,mask:h,motion:I}),n.createElement(en,{onResize:Y,disabled:!f},function(ke){return n.createElement(rn,Kr({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:K,leavedClassName:"".concat(o,"-hidden")},g,{onAppearPrepare:Se,onEnterPrepare:Se,visible:f,onVisibleChanged:function(se){var J;g==null||(J=g.onVisibleChanged)===null||J===void 0||J.call(g,se),d(se)}}),function(he,se){var J=he.className,be=he.style,ce=Fe(o,J,u);return n.createElement("div",{ref:wn(ke,t,se),className:ce,style:A(A(A(A({},le),_),be),{},{boxSizing:"border-box",zIndex:v},l),onMouseEnter:U,onMouseLeave:N,onClick:R},E&&n.createElement(Vn,{prefixCls:o,align:x,arrowX:C,arrowY:k}),ge)})}))}),_n=n.forwardRef(function(e,t){var r=e.children,u=e.getTriggerDOMNode,o=Zr(r),l=n.useCallback(function(d){Mn(t,u?u(d):d)},[u]),s=pr(l,r.ref);return o?n.cloneElement(r,{ref:s}):r}),Hn=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function An(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tn,t=n.forwardRef(function(r,u){var o=r.prefixCls,l=o===void 0?"rc-trigger-popup":o,s=r.children,d=r.action,f=d===void 0?"hover":d,m=r.showAction,R=r.hideAction,h=r.popupVisible,E=r.defaultPopupVisible,x=r.onPopupVisibleChange,C=r.afterPopupVisibleChange,k=r.mouseEnterDelay,g=r.mouseLeaveDelay,I=g===void 0?.1:g,K=r.focusDelay,V=r.blurDelay,Z=r.mask,b=r.maskClosable,v=b===void 0?!0:b,U=r.getPopupContainer,N=r.forceRender,ue=r.autoDestroy,p=r.destroyPopupOnHide,ee=r.popup,Y=r.popupClassName,Se=r.popupStyle,X=r.popupPlacement,re=r.builtinPlacements,L=re===void 0?{}:re,ge=r.popupAlign,Re=r.zIndex,W=r.stretch,F=r.getPopupClassNameFromAlign,z=r.alignPoint,O=r.onPopupClick,c=r.onPopupAlign,le=r.arrow,_=r.popupMotion,ke=r.maskMotion,he=r.popupTransitionName,se=r.popupAnimation,J=r.maskTransitionName,be=r.maskAnimation,ce=r.className,je=r.getTriggerDOMNode,ye=mn(r,Hn),cr=ue||p||!1,Ne=n.useRef({}),G=n.useContext(Yr),fr=n.useMemo(function(){return{registerSubPopup:function(i,y){Ne.current[i]=y,G==null||G.registerSubPopup(i,y)}}},[G]),Be=Sn(),vr=n.useState(null),qe=M(vr,2),j=qe[0],dr=qe[1],mr=n.useCallback(function(a){Vr(a)&&dr(a),G==null||G.registerSubPopup(Be,a)},[]),ne=n.useState(null),$=M(ne,2),Ce=$[0],Oe=$[1],fe=n.useCallback(function(a){Vr(a)&&Oe(a)},[]),P=n.Children.only(s),w=(P==null?void 0:P.props)||{},te={},Qe=We(function(a){var i=Ce;return(i==null?void 0:i.contains(a))||a===i||(j==null?void 0:j.contains(a))||a===j||Object.values(Ne.current).some(function(y){return y.contains(a)||a===y})}),Ue=Jr(l,_,se,he),Ye=Jr(l,ke,be,J),Pe=n.useState(E||!1),Xe=M(Pe,2),gr=Xe[0],xe=Xe[1],H=h??gr,Je=We(function(a){h===void 0&&xe(a)});q(function(){xe(h||!1)},[h]);var ae=n.useRef(H);ae.current=H;var De=We(function(a){H!==a&&(Je(a),x==null||x(a))}),$e=n.useRef(),Te=function(){clearTimeout($e.current)},B=function(i){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Te(),y===0?De(i):$e.current=setTimeout(function(){De(i)},y*1e3)};n.useEffect(function(){return Te},[]);var Ve=n.useState(!1),Le=M(Ve,2),ze=Le[0],ve=Le[1],de=n.useRef(!0);q(function(){(!de.current||H)&&ve(!0),de.current=!0},[H]);var _e=n.useState(null),Ge=M(_e,2),we=Ge[0],Ke=Ge[1],Ze=n.useState([0,0]),pe=M(Ze,2),He=pe[0],hr=pe[1],Ae=function(i){hr([i.clientX,i.clientY])},yr=$n(H,j,z?He:Ce,X,L,ge,c),Q=M(yr,9),Cr=Q[0],wr=Q[1],Mr=Q[2],Sr=Q[3],Rr=Q[4],oe=Q[5],T=Q[6],Me=Q[7],Ie=Q[8],ie=We(function(){ze||Ie()});Tn(H,Ce,j,ie),q(function(){ie()},[He]),q(function(){H&&!(L!=null&&L[X])&&ie()},[JSON.stringify(ge)]);var br=n.useMemo(function(){var a=xn(L,l,Me,z);return Fe(a,F==null?void 0:F(Me))},[Me,F,L,l,z]);n.useImperativeHandle(u,function(){return{forceAlign:ie}});var Pr=function(i){ve(!1),Ie(),C==null||C(i)},Dr=function(){return new Promise(function(i){Ke(function(){return i})})};q(function(){we&&(Ie(),we(),Ke(null))},[we]);var Er=n.useState(0),er=M(Er,2),kr=er[0],Nr=er[1],an=n.useState(0),zr=M(an,2),on=zr[0],un=zr[1],ln=function(i,y){if(ie(),W){var D=y.getBoundingClientRect();Nr(D.width),un(D.height)}},sn=kn(f,m,R),_r=M(sn,2),rr=_r[0],nr=_r[1],tr=function(i,y,D,S){te[i]=function(Fr){var or;S==null||S(Fr),B(y,D);for(var $r=arguments.length,jr=new Array($r>1?$r-1:0),ir=1;ir<$r;ir++)jr[ir-1]=arguments[ir];(or=w[i])===null||or===void 0||or.call.apply(or,[w,Fr].concat(jr))}},Hr=rr.has("click"),ar=nr.has("click")||nr.has("contextMenu");(Hr||ar)&&(te.onClick=function(a){var i;ae.current&&ar?B(!1):!ae.current&&Hr&&(Ae(a),B(!0));for(var y=arguments.length,D=new Array(y>1?y-1:0),S=1;S<y;S++)D[S-1]=arguments[S];(i=w.onClick)===null||i===void 0||i.call.apply(i,[w,a].concat(D))}),n.useEffect(function(){if(ar&&j&&(!Z||v)){var a=function(D){var S=D.target;ae.current&&!Qe(S)&&B(!1)},i=sr(j);return i.addEventListener("click",a),function(){i.removeEventListener("click",a)}}},[ar,j,Z,v]);var cn=rr.has("hover"),fn=nr.has("hover"),Ar,Ir;cn&&(tr("onMouseEnter",!0,k,function(a){Ae(a)}),Ar=function(){B(!0,k)},z&&(te.onMouseMove=function(a){var i;(i=w.onMouseMove)===null||i===void 0||i.call(w,a)})),fn&&(tr("onMouseLeave",!1,I),Ir=function(){B(!1,I)}),rr.has("focus")&&tr("onFocus",!0,K),nr.has("focus")&&tr("onBlur",!1,V),rr.has("contextMenu")&&(te.onContextMenu=function(a){var i;Ae(a),B(!0),a.preventDefault();for(var y=arguments.length,D=new Array(y>1?y-1:0),S=1;S<y;S++)D[S-1]=arguments[S];(i=w.onContextMenu)===null||i===void 0||i.call.apply(i,[w,a].concat(D))}),ce&&(te.className=Fe(w.className,ce));var xr=A(A({},w),te),Wr={},vn=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];vn.forEach(function(a){ye[a]&&(Wr[a]=function(){for(var i,y=arguments.length,D=new Array(y),S=0;S<y;S++)D[S]=arguments[S];(i=xr[a])===null||i===void 0||i.call.apply(i,[xr].concat(D)),ye[a].apply(ye,D)})});var dn=n.cloneElement(P,A(A({},xr),Wr));return n.createElement(n.Fragment,null,n.createElement(en,{disabled:!H,ref:fe,onResize:ln},n.createElement(_n,{getTriggerDOMNode:je},dn)),n.createElement(Yr.Provider,{value:fr},n.createElement(zn,{portal:e,ref:mr,prefixCls:l,popup:ee,className:Fe(Y,br),style:Se,target:Ce,onMouseEnter:Ar,onMouseLeave:Ir,zIndex:Re,open:H,keepDom:ze,onClick:O,mask:Z,motion:Ue,maskMotion:Ye,onVisibleChanged:Pr,onPrepare:Dr,forceRender:N,autoDestroy:cr,getPopupContainer:U,align:Me,arrow:le,ready:Cr,offsetX:wr,offsetY:Mr,arrowX:Sr,arrowY:Rr,onAlign:ie,stretch:W,targetWidth:kr/oe,targetHeight:on/T})))});return t}const Qn=An(tn);export{tn as P,Qn as T};
